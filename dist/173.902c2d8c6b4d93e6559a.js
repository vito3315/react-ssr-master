(self.webpackChunkreact_ssr=self.webpackChunkreact_ssr||[]).push([[173],{7173:(t,e,a)=>{"use strict";a.r(e),a.d(e,{Actii:()=>M});var i=a(6610),n=a(5991),o=a(3349),s=a(379),c=a(6070),r=a(7608),l=a(6156),m=a(7294),p=a(1749),h=a(282),u=a(4837),d=a(7812),g=a(2318),f=a(7625),y=a(1436),v=a(2663),_=a(6083),w=a(9525),Z=a(6856),S=a(6912),E=a(9669),x=a.n(E),C=a(4593),b=a(6282);var k=a(7563),M=function(t){(0,s.Z)(M,t);var e,a,E=(e=M,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,r.Z)(e);if(a){var n=(0,r.Z)(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return(0,c.Z)(this,t)});function M(t){var e;return(0,i.Z)(this,M),e=E.call(this,t),(0,l.Z)((0,o.Z)(e),"componentDidMount",(function(){document.querySelector(".activeCat")&&document.querySelector(".activeCat").classList.remove("activeCat"),window.scrollTo(0,0),b.Z.setPage("actii"),M.fetchData("/"+e.state.city_name).then((function(t){e.setState({title:t.page.title,description:t.page.description})})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:k.stringify({type:"get_my_actii_web",city_id:e.state.city_name})}).then((function(t){return t.json()})).then((function(t){e.setState({actii:t.actii,is_load:!0}),setTimeout((function(){var a=window.location.hash;if(a.length>0){var i=a.split("#act")[1],n=t.actii.find((function(t){return t.id==i}));e.openDialog(n),e.props.history.replace({pathname:window.location.pathname})}}),300)})).catch((function(t){}))})),e.state={actii:[],pre_actii:[1,2,3,4],is_load:!1,showItem:null,openDialog:!1,title:"",description:"",city_name:t.match.params.cityName,openMSG:!1,statusMSG:!1,textMSG:""},b.Z.setCity(t.match.params.cityName),e}return(0,n.Z)(M,[{key:"closeDialog",value:function(){this.setState({showItem:null,openDialog:!1})}},{key:"openDialog",value:function(t){var e=b.Z.getAllItems();t.items.map((function(a,i){t.items[i].item=e.find((function(t){return t.id==a.item_id}))})),this.setState({showItem:t,openDialog:!0})}},{key:"closeAlert",value:function(){this.setState({openMSG:!1})}},{key:"activePromo",value:function(t,e){var a=this;b.Z.setPromo(JSON.stringify(t),e);var i=b.Z.checkPromo();setTimeout((function(){i.st?a.setState({openMSG:!0,statusMSG:!0,textMSG:"Промокод применен"}):a.setState({openMSG:!0,statusMSG:!1,textMSG:i.text})}),300)}},{key:"render",value:function(){var t=this;return m.createElement(p.Z,{container:!0,className:"Actii mainContainer MuiGrid-spacing-xs-3"},m.createElement(C.q,null,m.createElement("title",null,this.state.title),m.createElement("meta",{name:"description",content:this.state.description})),m.createElement(S.Z,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.openMSG,autoHideDuration:3e3,onClose:this.closeAlert.bind(this),message:this.state.textMSG,style:{backgroundColor:this.state.statusMSG?"green":"#BB0025",borderRadius:4}}),m.createElement(p.Z,{item:!0,xs:12},m.createElement(g.Z,{variant:"h5",component:"h1"},"Акции")),m.createElement(p.Z,{item:!0,container:!0,spacing:3,md:10,sm:12,xs:12,xl:10,className:"mainContainer"},!1===this.state.is_load?this.state.pre_actii.map((function(t,e){return m.createElement(p.Z,{item:!0,xs:12,sm:6,md:3,xl:3,key:e,style:{padding:12}},m.createElement("div",{style:{width:"100%",height:300,backgroundColor:"#e5e5e5"}}))})):this.state.actii.map((function(e,a){return m.createElement(p.Z,{item:!0,xs:12,sm:6,md:4,xl:3,key:a},m.createElement("picture",null,m.createElement("source",{srcSet:"https://storage.yandexcloud.net/site-aktii/"+e.img_new+"750х750.webp?"+e.img_new_update,type:"image/webp"}),m.createElement("img",{src:"https://storage.yandexcloud.net/site-aktii/"+e.img_new+"750х750.jpg?"+e.img_new_update,alt:e.promo_title,title:e.promo_title,style:{width:"100%"},onClick:t.openDialog.bind(t,e)})))}))),m.createElement(p.Z,{item:!0,xs:12},m.createElement(g.Z,{variant:"h5",component:"h2"},this.state.page&&this.state.page.page_h?this.state.page.page_h:"")),this.state.page&&this.state.page.content?m.createElement(p.Z,{item:!0,container:!0,spacing:3,md:10,sm:12,xs:12,xl:10,className:"mainContainer dopText",dangerouslySetInnerHTML:{__html:this.state.page.content}}):null,this.state.showItem?m.createElement(v.Z,{onClose:this.closeDialog.bind(this),"aria-labelledby":"customized-dialog-title",className:"modalActii",open:this.state.openDialog},m.createElement(_.Z,{disableTypography:!0,style:{margin:0,padding:8}},m.createElement(g.Z,{variant:"h6"},this.state.showItem.promo_title),m.createElement(d.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0},onClick:this.closeDialog.bind(this)},m.createElement(f.G,{icon:y.NBC,style:{fontSize:"1.8rem",color:"#e5e5e5"}}))),m.createElement(w.Z,{className:"modalActiiContent"},m.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.showItem.text}})),this.state.showItem.promo.length>0?m.createElement(Z.Z,{style:{justifyContent:"center",padding:"15px 0px"}},m.createElement(u.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",onClick:this.activePromo.bind(this,this.state.showItem.info,this.state.showItem.promo)},m.createElement(h.Z,{variant:"contained",className:"BtnCardMain CardInCardItem"},"Применить промокод"))):null):null)}}],[{key:"fetchData",value:function(t){var e,a={type:"get_page_info",city_id:(e=t,e.split("/")[1]),page:"akcii"};return x()({method:"POST",url:"https://jacofood.ru/src/php/test_app.php",headers:{"content-type":"application/x-www-form-urlencoded"},data:k.stringify(a)}).then((function(t){if(200===t.status){var e=t.data;return{title:e.page.title,description:e.page.description,page:e.page}}})).catch((function(t){console.log(t)}))}}]),M}(m.Component)}}]);
//# sourceMappingURL=173.902c2d8c6b4d93e6559a.js.map