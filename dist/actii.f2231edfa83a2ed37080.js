(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[158],{7173:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Actii:()=>M});var a=i(6610),n=i(5991),o=i(3349),s=i(379),c=i(6070),r=i(7608),l=i(6156),m=i(7294),p=i(1749),h=i(282),u=i(4837),d=i(7812),g=i(2318),f=i(7625),y=i(1436),_=i(2663),v=i(6083),E=i(9525),S=i(6856),Z=i(6912),w=i(9669),x=i.n(w),C=i(4593),D=i(6282);var b=i(7563),M=function(t){(0,s.Z)(M,t);var e,i,w=(e=M,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=(0,r.Z)(e);if(i){var n=(0,r.Z)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,c.Z)(this,t)});function M(t){var e;return(0,a.Z)(this,M),e=w.call(this,t),(0,l.Z)((0,o.Z)(e),"componentDidMount",(function(){document.querySelector(".activeCat")&&document.querySelector(".activeCat").classList.remove("activeCat"),window.scrollTo(0,0),D.Z.setPage("actii"),M.fetchData("/"+e.state.city_name).then((function(t){e.setState({title:t.page.title,description:t.page.description})})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:b.stringify({type:"get_my_actii_web",city_id:e.state.city_name})}).then((function(t){return t.json()})).then((function(t){e.setState({actii:t.actii,is_load:!0}),setTimeout((function(){var i=window.location.hash;if(i.length>0){var a=i.split("#act")[1],n=t.actii.find((function(t){return t.id==a}));e.openDialog(n),e.props.history.replace({pathname:window.location.pathname})}}),300)})).catch((function(t){}))})),e.state={actii:[],pre_actii:[1,2,3,4],is_load:!1,showItem:null,openDialog:!1,title:"",description:"",city_name:t.match.params.cityName,openMSG:!1,statusMSG:!1,textMSG:""},D.Z.setCity(t.match.params.cityName),e}return(0,n.Z)(M,[{key:"closeDialog",value:function(){this.setState({showItem:null,openDialog:!1})}},{key:"openDialog",value:function(t){var e=D.Z.getAllItems();t.items.map((function(i,a){t.items[a].item=e.find((function(t){return t.id==i.item_id}))})),this.setState({showItem:t,openDialog:!0})}},{key:"closeAlert",value:function(){this.setState({openMSG:!1})}},{key:"activePromo",value:function(t,e){var i=this;D.Z.setPromo(JSON.stringify(t),e);var a=D.Z.checkPromo();setTimeout((function(){a.st?i.setState({openMSG:!0,statusMSG:!0,textMSG:"Промокод применен"}):i.setState({openMSG:!0,statusMSG:!1,textMSG:a.text})}),300)}},{key:"render",value:function(){var t=this;return m.createElement(p.Z,{container:!0,className:"Actii mainContainer MuiGrid-spacing-xs-3"},m.createElement(C.q,null,m.createElement("title",null,this.state.title),m.createElement("meta",{name:"description",content:this.state.description})),m.createElement(Z.Z,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.openMSG,autoHideDuration:3e3,onClose:this.closeAlert.bind(this),message:this.state.textMSG,style:{backgroundColor:this.state.statusMSG?"green":"#BB0025",borderRadius:4}}),m.createElement(p.Z,{item:!0,xs:12},m.createElement(g.Z,{variant:"h5",component:"h1"},"Акции")),m.createElement(p.Z,{item:!0,container:!0,spacing:3,md:10,sm:12,xs:12,xl:10,className:"mainContainer"},!1===this.state.is_load?this.state.pre_actii.map((function(t,e){return m.createElement(p.Z,{item:!0,xs:12,sm:6,md:3,xl:3,key:e,style:{padding:12}},m.createElement("div",{style:{width:"100%",height:300,backgroundColor:"#e5e5e5"}}))})):this.state.actii.map((function(e,i){return m.createElement(p.Z,{item:!0,xs:12,sm:6,md:4,xl:3,key:i},m.createElement("picture",null,m.createElement("source",{srcSet:"https://storage.yandexcloud.net/site-aktii/"+e.img_new+"750х750.webp?"+e.img_new_update,type:"image/webp"}),m.createElement("img",{src:"https://storage.yandexcloud.net/site-aktii/"+e.img_new+"750х750.jpg?"+e.img_new_update,alt:e.promo_title,title:e.promo_title,style:{width:"100%"},onClick:t.openDialog.bind(t,e)})))}))),m.createElement(p.Z,{item:!0,xs:12},m.createElement(g.Z,{variant:"h5",component:"h2"},this.state.page&&this.state.page.page_h?this.state.page.page_h:"")),this.state.page&&this.state.page.content?m.createElement(p.Z,{item:!0,container:!0,spacing:3,md:10,sm:12,xs:12,xl:10,className:"mainContainer dopText",dangerouslySetInnerHTML:{__html:this.state.page.content}}):null,this.state.showItem?m.createElement(_.Z,{onClose:this.closeDialog.bind(this),"aria-labelledby":"customized-dialog-title",className:"modalActii",open:this.state.openDialog},m.createElement(v.Z,{disableTypography:!0,style:{margin:0,padding:8}},m.createElement(g.Z,{variant:"h6"},this.state.showItem.promo_title),m.createElement(d.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0},onClick:this.closeDialog.bind(this)},m.createElement(f.G,{icon:y.NBC,style:{fontSize:"1.8rem",color:"#e5e5e5"}}))),m.createElement(E.Z,{className:"modalActiiContent"},m.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.showItem.text}})),this.state.showItem.promo.length>0?m.createElement(S.Z,{style:{justifyContent:"center",padding:"15px 0px"}},m.createElement(u.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",onClick:this.activePromo.bind(this,this.state.showItem.info,this.state.showItem.promo)},m.createElement(h.Z,{variant:"contained",className:"BtnCardMain CardInCardItem"},"Применить промокод"))):null):null)}}],[{key:"fetchData",value:function(t){var e,i={type:"get_page_info",city_id:(e=t,e.split("/")[1]),page:"akcii"};return x()({method:"POST",url:"https://jacofood.ru/src/php/test_app.php",headers:{"content-type":"application/x-www-form-urlencoded"},data:b.stringify(i)}).then((function(t){if(200===t.status){var e=t.data;return{title:e.page.title,description:e.page.description,page:e.page}}})).catch((function(t){console.log(t)}))}}]),M}(m.Component)}}]);
//# sourceMappingURL=actii.f2231edfa83a2ed37080.js.map